# Render Blueprint - deploy both services with one click
# https://render.com/docs/blueprint-spec

services:
  # ── Backend (FastAPI) ──────────────────────────────────────
  - type: web
    name: blackforge-backend
    runtime: docker
    rootDir: backend
    dockerfilePath: ./Dockerfile
    plan: free
    envVars:
      - key: PYTHONPATH
        value: /app
      - key: DATABASE_URL
        fromDatabase:
          name: blackforge-db
          property: connectionString
    healthCheckPath: /health

  # ── Frontend (React) ──────────────────────────────────────
  - type: web
    name: blackforge-frontend
    runtime: docker
    rootDir: frontend
    dockerfilePath: ./Dockerfile
    plan: free
    envVars:
      - key: REACT_APP_API_URL
        fromService:
          name: blackforge-backend
          type: web
          envVarKey: RENDER_EXTERNAL_URL

# ── Database ─────────────────────────────────────────────────
databases:
  - name: blackforge-db
    plan: free
    databaseName: blackforge_db
    user: blackforge
